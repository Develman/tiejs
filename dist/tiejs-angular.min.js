/*!
 TieJS - http://develman.github.io/tiejs
 Licensed under the MIT license
 */
angular.module("tiejs-ang",[]).directive("tiejsForm",function(){return{restrict:"E",scope:{formName:"@formName",showRequiredAsterisk:"@showRequiredAsterisk",fields:"=fields",bindings:"=bindings",bindingSource:"=bindingSource",onSubmit:"=onSubmit",submitButtonId:"@submitButtonId"},template:"<form></form>",link:function(e,t,n){var r=new Array;var i={showRequiredAsterisk:e.showRequiredAsterisk,formName:e.formName,bindingSource:e.bindingSource,onSubmit:e.onSubmit};var s=t.find("form");s.TieJS(i);var o=s.data("tiejs");var u=function(t){t.forEach(function(t){if(t.type==="color"){e.bindings.forEach(function(e){var n=e[t.data.name];if(n)r.push(n)})}})};e.fields.forEach(function(e){if(e.fieldData){if(e.fieldType==="field"){o.addFields(e.fieldData);u(e.fieldData)}else if(e.fieldType==="column"){o.addColumns(e.fieldData)}else{if(console)console.log("tiejs-directive: unknown type of field (only type -field- and -column- are allowed)")}}});o.addBindings(e.bindings);var a=new Array;if(r.length>0){var f=s.find(".colorpicker");for(var l=0;l<r.length;l++){var c=$(f[l]).colorpicker({format:"hex",color:"#"+e.bindingSource[r[l]]});c.on("changeColor",function(t){var n=t.color.toHex();e.bindingSource[r[l]]=n.replace("#","")});a.push(c)}}$("#"+e.submitButtonId).on("click",function(){s.trigger("submit")})}}})