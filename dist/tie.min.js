(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){"use strict";var t=function(t,n){function u(){if(o.formName){i.attr("name",o.formName)}if(o.showRequiredAsterisk){var t=e("<p class='required-info'>Mit <span class='required-sign'>*</span> markierte Felder sind Pflichtfelder</p>");i.prepend(t)}i.addClass("tiejs-form");i.on("submit",function(e){e.preventDefault();if(c(i,s)){o.onSubmit()}})}function S(t){t.find("div.alert").remove();t.find(".form-group").each(function(t,n){e(n).removeClass("has-error has-feedback");e(n).find(".form-control-feedback").remove()})}function x(t,n){var r=e(t).attr(n);return typeof r!=="undefined"&&r!==false}function T(t){var n=e("<div></div>");n.addClass("alert alert-danger");n.text("Bitte beheben Sie die im Formular hervorgehobenen Fehler");t.prepend(n)}function N(e){var t=e.parent();if(t.hasClass("input-group")){t=t.parent()}t.addClass("has-error has-feedback");if(e.is("select")){t.append("<span class='fa fa-times form-control-feedback feedback-select'></span>")}else{t.append("<span class='fa fa-times form-control-feedback'></span>")}}function C(e,t,n){var r=e.attr("type");switch(r){case"checkbox":var i=t[n];if(i==0){e.prop("checked",false)}else{e.prop("checked",true)}break;case"radio":e.val([t[n]]);break;default:var s=t[n];e.val(s)}}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.name===e){return r}}return null}function L(){return'<div class="btn-toolbar" data-role="editor-toolbar" data-target="#editor">'+'<div class="btn-group">'+'<a class="btn btn-xs btn-primary dropdown-toggle" data-toggle="dropdown" title="" data-original-title="Font"><i class="glyphicon glyphicon-font"></i><b class="caret"></b></a>'+'<ul class="dropdown-menu">'+'<li><a data-edit="fontName Serif" style="font-family:'+"'Serif'"+">Serif</a></li>"+'<li><a data-edit="fontName Sans" style="font-family:'+"'Sans'"+'">Sans</a></li>'+'<li><a data-edit="fontName Arial" style="font-family:'+"'Arial'"+'">Arial</a></li>'+'<li><a data-edit="fontName Arial Black" style="font-family:'+"'Arial Black'"+'">Arial Black</a></li>'+'<li><a data-edit="fontName Courier" style="font-family:'+"'Courier'"+'">Courier</a></li>'+'<li><a data-edit="fontName Courier New" style="font-family:'+"'Courier New'"+'">Courier New</a></li>'+'<li><a data-edit="fontName Comic Sans MS" style="font-family:'+"'Comic Sans MS'"+'">Comic Sans MS</a></li>'+'<li><a data-edit="fontName Helvetica" style="font-family:'+"'Helvetica'"+'">Helvetica</a></li>'+'<li><a data-edit="fontName Impact" style="font-family:'+"'Impact'"+'">Impact</a></li>'+'<li><a data-edit="fontName Lucida Grande" style="font-family:'+"'Lucida Grande'"+'">Lucida Grande</a></li>'+'<li><a data-edit="fontName Lucida Sans" style="font-family:'+"'Lucida Sans'"+'">Lucida Sans</a></li>'+'<li><a data-edit="fontName Tahoma" style="font-family:'+"'Tahoma'"+'">Tahoma</a></li>'+'<li><a data-edit="fontName Times" style="font-family:'+"'Times'"+'">Times</a></li>'+'<li><a data-edit="fontName Times New Roman" style="font-family:'+"'Times New Roman'"+'">Times New Roman</a></li>'+'<li><a data-edit="fontName Verdana" style="font-family:'+"'Verdana'"+'">Verdana</a></li></ul> '+"</div>"+'<div class="btn-group">'+'<a class="btn btn-xs btn-primary dropdown-toggle" data-toggle="dropdown" title="" data-original-title="Font Size"><i class="glyphicon glyphicon-text-height"></i>&nbsp;<b class="caret"></b></a>'+'<ul class="dropdown-menu">'+'<li><a data-edit="fontSize 5"><font size="5">Huge</font></a></li>'+'<li><a data-edit="fontSize 3"><font size="3">Normal</font></a></li>'+'<li><a data-edit="fontSize 1"><font size="1">Small</font></a></li>'+"</ul>"+"</div>"+'<div class="btn-group">'+'<a class="btn btn-xs btn-primary" data-edit="bold" title="" data-original-title="Bold (Ctrl/Cmd+B)"><i class="glyphicon glyphicon-bold"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="italic" title="" data-original-title="Italic (Ctrl/Cmd+I)"><i class="glyphicon glyphicon-italic"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="underline" title="" data-original-title="Underline (Ctrl/Cmd+U)"><i class="glyphicon glyphicon-text-width"></i></a>'+"</div>"+'<div class="btn-group">'+'<a class="btn btn-xs btn-primary" data-edit="insertunorderedlist" title="" data-original-title="Bullet list"><i class="glyphicon glyphicon-list"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="insertorderedlist" title="" data-original-title="Number list"><i class="glyphicon glyphicon-list-alt"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="outdent" title="" data-original-title="Reduce indent (Shift+Tab)"><i class="glyphicon glyphicon-indent-left"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="indent" title="" data-original-title="Indent (Tab)"><i class="glyphicon glyphicon-indent-right"></i></a>'+"</div>"+'<div class="btn-group">'+'<a class="btn btn-xs btn-primary" data-edit="justifyleft" title="" data-original-title="Align Left (Ctrl/Cmd+L)"><i class="glyphicon glyphicon-align-left"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="justifycenter" title="" data-original-title="Center (Ctrl/Cmd+E)"><i class="glyphicon glyphicon-align-center"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="justifyright" title="" data-original-title="Align Right (Ctrl/Cmd+R)"><i class="glyphicon glyphicon-align-right"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="justifyfull" title="" data-original-title="Justify (Ctrl/Cmd+J)"><i class="glyphicon glyphicon-align-justify"></i></a>'+"</div>"+'<div class="btn-group">'+'<a class="btn btn-xs btn-primary dropdown-toggle" data-toggle="dropdown" title="" data-original-title="Hyperlink"><i class="glyphicon glyphicon-link"></i></a>'+'<div class="dropdown-menu input-append">'+'<input class="span2" placeholder="URL" type="text" data-edit="createLink">'+'<button class="btn" type="button">Add</button>'+"</div>"+'<a class="btn btn-xs btn-primary" data-edit="unlink" title="" data-original-title="Remove Hyperlink"><i class="glyphicon glyphicon-remove"></i></a>'+"</div>"+'<div class="btn-group">'+'<a class="btn btn-xs btn-primary" title="" id="pictureBtn" data-original-title="Insert picture (or just drag & drop)"><i class="glyphicon glyphicon-picture"></i></a>'+'<input type="file" data-role="magic-overlay" data-target="#pictureBtn" data-edit="insertImage" style="opacity: 0; position: absolute; top: 0px; left: 0px; width: 37px; height: 30px;">'+"</div>"+'<div class="btn-group">'+'<a class="btn btn-xs btn-primary" data-edit="undo" title="" data-original-title="Undo (Ctrl/Cmd+Z)"><i class="glyphicon glyphicon-backward"></i></a>'+'<a class="btn btn-xs btn-primary" data-edit="redo" title="" data-original-title="Redo (Ctrl/Cmd+Y)"><i class="glyphicon glyphicon-forward"></i></a>'+"</div>"+"</div>"}var r=e(this);var i=e(t);var s=[];var o=e.extend({showRequiredAsterisk:true,formName:null,bindingSource:{},onSubmit:function(){}},n);u();this.addFields=function(t){e.each(t,function(e,t){if(t.data){i.append(a(t.type,t.data));if(k(t.data.name,s)===null){s.push({name:t.data.name,binding:""})}}});return this};this.addColumns=function(e){if(e.length>0){i.append(f(e,s))}return this};this.addBindings=function(t){if(o.bindingSource){e.each(t,function(t,n){e.each(n,function(e,t){l(i,o.bindingSource,e,t);var n=k(e,s);n.binding=t})})}return this};this.captureFields=function(){i.find(".form-control").each(function(t,n){var r=e(n).attr("name");if(k(r,s)===null){s.push({name:r,binding:""})}});return this};this.updateSettings=function(t){e.extend(o,t);this.reload()};this.reload=function(){S(i);e.each(s,function(e,t){l(i,o.bindingSource,t.name,t.binding)})};this.markFieldError=function(t){e.each(t,function(e,t){var n=i.find("[name="+t+"]");N(n)})};var a=function(e,t){var n=null;switch(e){case"text":case"number":case"email":case"password":case"regex":n=h(e,t);break;case"checkbox":n=p(t);break;case"radio":n=d(t);break;case"select":n=v(t);break;case"color":n=m(t);break;case"date":n=g(t);break;case"time":n=y(t);break;case"longtext":n=b(t);break;case"wysiwyg":n=w(t);break;case"button":n=E(t);break}return n};var f=function(t,n){var r=e("<div></div>");r.addClass("row");e.each(t,function(t,i){var s=e("<div></div>");s.addClass("col-md-6");if(i.data){s.append(a(i.type,i.data));if(k(i.data.name,n)===null){n.push({name:i.data.name,binding:""})}}r.append(s)});return r};var l=function(e,t,n,r){var i=e.find("[name="+n+"]");if(i&&typeof t[r]!=="undefined"){var s=i.attr("type");if(i.is("select")){s="select"}i.on("change",function(){switch(s){case"checkbox":var o=i.is(":checked")?1:0;t[r]=o;break;case"radio":var o=e.find("input[name="+n+"]:checked").val();t[r]=o;break;case"select":var o=e.find("select[name="+n+"] option:selected").val();t[r]=o;break;default:t[r]=i.val()}});C(i,t,r)}};var c=function(t,n){S(t);var r=true;e.each(n,function(n,i){var s=t.find("[name="+i.name+"]");var o=s.val();if(x(s,"required")){if(!o||s.is("select")&&o=="0"){r=false;N(s)}}var u=s.attr("type");switch(u){case"number":if(o&&!e.isNumeric(o)){r=false;N(s)}break;case"email":var a=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(o&&!a.test(o)){r=false;N(s)}break}var f=s.attr("data-regex");if(f){var a=new RegExp(f);if(o&&!a.test(o)){r=false;N(s)}}});if(!r){T(t)}return r};var h=function(t,n){var r=e("<div></div>");r.addClass("form-group");var i=n.label;if(o.showRequiredAsterisk&&n.required){i+="<span class='required-sign'>*</span>"}r.append("<label class='control-label'>"+i+":</label>");var s="<input type='"+t+"' name='"+n.name+"' class='form-control'";if(n.css){s=s.slice(0,-1);s+=" "+n.css+"'"}if(n.placeholder){s+=" placeholder='"+n.placeholder+"'"}if(n.attributes){s+=" "+n.attributes}if(n.required){s+=" required"}if(n.regex){s+=" data-regex='"+n.regex+"'"}s+=" />";r.append(s);return r};var p=function(t){var n=e("<div></div>");n.addClass("checkbox");var r=e("<label></label>");r.addClass("control-label");var i="<input type='checkbox' name='"+t.name+"'";if(t.css){i+=" class='"+t.css+"'"}if(t.attributes){i+=" "+t.attributes}if(t.required){i+=" required"}i+=" />";r.append(i);var s=t.label;if(o.showRequiredAsterisk&&t.required){s+="<span class='required-sign'>*</span>"}r.append(s);n.append(r);return n};var d=function(t){var n=e("<div></div>");n.addClass("radio");var r=e("<label></label>");r.addClass("control-label");var i="<input type='radio' name='"+t.name+"'";if(t.css){i+=" class='"+t.css+"'"}if(t.attributes){i+=" "+t.attributes}if(t.required){i+=" required"}i+=" />";r.append(i);var s=t.label;if(o.showRequiredAsterisk&&t.required){s+="<span class='required-sign'>*</span>"}r.append(s);n.append(r);return n};var v=function(t){var n=e("<div></div>");n.addClass("form-group");var r=t.label;if(o.showRequiredAsterisk&&t.required){r+="<span class='required-sign'>*</span>"}n.append("<label class='control-label'>"+r+":</label>");var i="<select name='"+t.name+"' class='form-control'";if(t.css){i=input.slice(0,-1);i+=" "+t.css+"'"}if(t.attributes){i+=" "+t.attributes}if(t.required){i+=" required"}i+=">";if(t.placeholder){i+="<option value='0' disabled selected>"+t.placeholder+"</option>"}if(t.options){e.each(t.options,function(e,t){i+="<option value='"+t.id+"'>"+t.name+"</option>"})}i+="</select>";n.append(i);return n};var m=function(t){var n=e("<div></div>");n.addClass("form-group");var r=t.label;if(o.showRequiredAsterisk&&t.required){r+="<span class='required-sign'>*</span>"}n.append("<label class='control-label'>"+r+":</label>");var i=e("<div></div>");i.addClass("input-group color");var s="<input type='text' name='"+t.name+"' class='form-control'";if(t.css){s=s.slice(0,-1);s+=" "+t.css+"'"}if(t.placeholder){s+=" placeholder='"+t.placeholder+"'"}if(t.attributes){s+=" "+t.attributes}if(t.required){s+=" required"}s+=" />";var u=e("<span></span>");u.addClass("input-group-addon");u.html("<i></i>");i.append(s);i.append(u);n.append(i);return n};var g=function(t){var n=e("<div></div>");n.addClass("form-group");var r=t.label;if(o.showRequiredAsterisk&&t.required){r+="<span class='required-sign'>*</span>"}n.append("<label class='control-label'>"+r+":</label>");var i=e("<div></div>");i.addClass("input-group date");var s="<input type='text' name='"+t.name+"' class='form-control'"+" data-date-format='"+t.format+"'";if(t.css){s=s.slice(0,-1);s+=" "+t.css+"'"}if(t.placeholder){s+=" placeholder='"+t.placeholder+"'"}if(t.attributes){s+=" "+t.attributes}if(t.regex){s+=" data-regex='"+t.regex+"'"}if(t.required){s+=" required"}s+=" />";var u=e("<span></span>");u.addClass("input-group-addon");u.html('<i class="fa fa-calendar"></i>');i.append(s);i.append(u);n.append(i);return n};var y=function(t){var n=e("<div></div>");n.addClass("form-group");var r=t.label;if(o.showRequiredAsterisk&&t.required){r+="<span class='required-sign'>*</span>"}n.append("<label class='control-label'>"+r+":</label>");var i=e("<div></div>");i.addClass("input-group time");var s="<input type='text' name='"+t.name+"' class='form-control'";if(t.css){s=s.slice(0,-1);s+=" "+t.css+"'"}if(t.placeholder){s+=" placeholder='"+t.placeholder+"'"}if(t.attributes){s+=" "+t.attributes}if(t.regex){s+=" data-regex='"+t.regex+"'"}if(t.required){s+=" required"}s+=" />";var u=e("<span></span>");u.addClass("input-group-addon");u.html('<i class="fa fa-clock-o"></i>');i.append(s);i.append(u);n.append(i);return n};var b=function(t){var n=e("<div></div>");n.addClass("form-group");var r=t.label;if(o.showRequiredAsterisk&&t.required){r+="<span class='required-sign'>*</span>"}n.append("<label class='control-label'>"+r+":</label>");var i="<textarea name='"+t.name+"' class='form-control'";if(t.css){i=i.slice(0,-1);i+=" "+t.css+"'"}if(t.placeholder){i+=" placeholder='"+t.placeholder+"'"}if(t.attributes){i+=" "+t.attributes}if(t.required){i+=" required"}i+="></textarea>";n.append(i);return n};var w=function(t){var n=e("<div></div>");n.addClass("form-group");var r=t.label;n.append("<label class='control-label'>"+r+":</label>");n.append(L());var i="<div name='"+t.name+"' class='form-control wysiwyg'";if(t.css){i=i.slice(0,-1);i+=" "+t.css+"'"}if(t.placeholder){i+=" placeholder='"+t.placeholder+"'"}if(t.attributes){i+=" "+t.attributes}if(t.required){i+=" required"}i+="></div>";n.append(i);return n};var E=function(t){var n=e("<div></div>");n.addClass("form-group");var r="<button type='button' class='btn btn-default'";if(t.css){r=r.slice(0,-1);r+=" "+t.css+"'"}r+=">"+t.label+"</button>";n.append(r);if(t.clickCB){var i=n.find("button");e(i).on("click",t.clickCB)}return n}};e.fn.TieJS=function(n){return this.each(function(){var r=e(this);if(r.data("tiejs")){return}r.data("tiejs",new t(this,n))})}})
