/*!
TieJS - http://develman.github.io/tiejs
Licensed under the MIT license
*/
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";var b=function(b,c){function p(b){b.find("div.alert").remove(),b.find(".form-group").each(function(b,c){a(c).removeClass("has-error has-feedback"),a(c).find(".form-control-feedback").remove()})}function q(b,c){var d=a(b).attr(c);return"undefined"!=typeof d&&d!==!1}function r(a){var b=a.parent();b.addClass("has-error has-feedback"),b.append("<span class='fa fa-times form-control-feedback'></span>")}function s(a,b,c){var d=a.attr("type");switch(d){case"checkbox":var e=b[c];0==e?a.prop("checked",!1):a.prop("checked",!0);break;case"radio":a.val([b[c]]);break;default:a.val(b[c])}}function t(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d.name===a)return d}return null}a(this);var e=a(b),f=[],g=a.extend({formName:null,bindingSource:{},onSubmit:function(){}},c);g.formName&&e.attr("name",g.formName),e.on("submit",function(a){a.preventDefault(),k(e,f)&&g.onSubmit()}),this.addFields=function(b){return a.each(b,function(a,b){b.data&&(e.append(h(b.type,b.data)),null===t(b.data.name,f)&&f.push({name:b.data.name,binding:""}))}),this},this.addColumns=function(a){return a.length>0&&e.append(i(a,f)),this},this.addBindings=function(b){return g.bindingSource&&a.each(b,function(b,c){a.each(c,function(a,b){j(e,g.bindingSource,a,b);var c=t(a,f);c.binding=b})}),this},this.reload=function(){a.each(f,function(a,b){var c=e.find("input[name="+b.name+"]");c&&"undefined"!=typeof g.bindingSource[b.binding]&&s(c,g.bindingSource,b.binding)})},this.markFieldError=function(b){a.each(b,function(a,b){var c=e.find("input[name="+b+"]");r(c)})};var h=function(a,b){var c=null;switch(a){case"text":case"number":case"time":case"email":case"password":c=l(a,b);break;case"checkbox":c=m(b);break;case"radio":c=n(b);break;case"button":c=o(b)}return c},i=function(b,c){var d=a("<div></div>");return d.addClass("row"),a.each(b,function(b,e){var f=a("<div></div>");f.addClass("col-md-6"),e.data&&(f.append(h(e.type,e.data)),null===t(e.data.name,c)&&c.push({name:e.data.name,binding:""})),d.append(f)}),d},j=function(a,b,c,d){var e=a.find("input[name="+c+"]");if(e&&"undefined"!=typeof b[d]){var f=e.attr("type");e.on("change",function(){switch(f){case"checkbox":var g=e.is(":checked")?1:0;b[d]=g;break;case"radio":var g=a.find("input[name="+c+"]:checked").val();b[d]=g;break;default:b[d]=e.val()}}),s(e,b,d)}},k=function(b,c){p(b);var d=!0;if(a.each(c,function(c,e){var f=b.find("input[name="+e.name+"]");q(f,"required")&&(a(f).val()||(d=!1,r(f)));var g=a(f).val(),h=a(f).attr("type");switch(h){case"number":a.isNumeric(g)||(d=!1,r(f));break;case"email":var i=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;i.test(g)||(d=!1,r(f))}}),!d){var e=a("<div></div>");e.addClass("alert alert-danger"),e.text("Bitte beheben Sie die im Formular hervorgehobenen Fehler"),b.prepend(e)}return d},l=function(b,c){var d=a("<div></div>");d.addClass("form-group"),d.append("<label class='control-label'>"+c.label+":</label>");var e="<input type='"+b+"' name='"+c.name+"' class='form-control'";return c.css&&(e=e.slice(0,-1),e+=" "+c.css+"'"),c.placeholder&&(e+=" placeholder='"+c.placeholder+"'"),c.attributes&&(e+=" "+c.attributes),e+=" />",d.append(e),d},m=function(b){var c=a("<div></div>");c.addClass("checkbox");var d=a("<label></label>");d.addClass("control-label");var e="<input type='checkbox' name='"+b.name+"'";return b.css&&(e=e.slice(0,-1),e+=" "+b.css+"'"),b.attributes&&(e+=" "+b.attributes),e+=" />",d.append(e),d.append(b.label),c.append(d),c},n=function(b){var c=a("<div></div>");c.addClass("radio");var d=a("<label></label>");d.addClass("control-label");var e="<input type='radio' name='"+b.name+"' value='"+b.value+"'";return b.css&&(e=e.slice(0,-1),e+=" "+b.css+"'"),b.attributes&&(e+=" "+b.attributes),e+=" />",d.append(e),d.append(b.label),c.append(d),c},o=function(a){var b="<button type='button' class='btn btn-default'";return a.css&&(b=b.slice(0,-1),b+=" "+a.css+"'"),b+=">"+a.label+"</button>"}};a.fn.TieJS=function(c){return this.each(function(){var d=a(this);d.data("tiejs")||d.data("tiejs",new b(this,c))})}});
