/*!
TieJS - http://develman.github.io/tiejs
Licensed under the MIT license
*/
(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){"use strict";var t=function(t,n){function m(t){t.find("div.alert").remove();t.find(".form-group").each(function(t,n){e(n).removeClass("has-error has-feedback");e(n).find(".form-control-feedback").remove()})}function g(t,n){var r=e(t).attr(n);return typeof r!=="undefined"&&r!==false}function y(t){var n=e("<div></div>");n.addClass("alert alert-danger");n.text("Bitte beheben Sie die im Formular hervorgehobenen Fehler");t.prepend(n)}function b(e){var t=e.parent();t.addClass("has-error has-feedback");if(e.is("select")){t.append("<span class='fa fa-times form-control-feedback feedback-select'></span>")}else{t.append("<span class='fa fa-times form-control-feedback'></span>")}}function w(e,t,n){var r=e.attr("type");switch(r){case"checkbox":var i=t[n];if(i==0){e.prop("checked",false)}else{e.prop("checked",true)}break;case"radio":e.val([t[n]]);break;default:e.val(t[n])}}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.name===e){return r}}return null}var r=e(this);var i=e(t);var s=[];var o=e.extend({formName:null,bindingSource:{},onSubmit:function(){}},n);if(o.formName){i.attr("name",o.formName)}i.on("submit",function(e){e.preventDefault();if(l(i,s)){o.onSubmit()}});this.addFields=function(t){e.each(t,function(e,t){if(t.data){i.append(u(t.type,t.data));if(E(t.data.name,s)===null){s.push({name:t.data.name,binding:""})}}});return this};this.addColumns=function(e){if(e.length>0){i.append(a(e,s))}return this};this.addBindings=function(t){if(o.bindingSource){e.each(t,function(t,n){e.each(n,function(e,t){f(i,o.bindingSource,e,t);var n=E(e,s);n.binding=t})})}return this};this.reload=function(){e.each(s,function(e,t){var n=i.find("[name="+t.name+"]");if(n&&typeof o.bindingSource[t.binding]!=="undefined"){w(n,o.bindingSource,t.binding)}})};this.markFieldError=function(t){e.each(t,function(e,t){var n=i.find("[name="+t+"]");b(n)})};var u=function(e,t){var n=null;switch(e){case"text":case"number":case"time":case"email":case"password":n=c(e,t);break;case"checkbox":n=h(t);break;case"radio":n=p(t);break;case"select":n=d(t);break;case"button":n=v(t);break}return n};var a=function(t,n){var r=e("<div></div>");r.addClass("row");e.each(t,function(t,i){var s=e("<div></div>");s.addClass("col-md-6");if(i.data){s.append(u(i.type,i.data));if(E(i.data.name,n)===null){n.push({name:i.data.name,binding:""})}}r.append(s)});return r};var f=function(e,t,n,r){var i=e.find("[name="+n+"]");if(i&&typeof t[r]!=="undefined"){var s=i.attr("type");i.on("change",function(){switch(s){case"checkbox":var o=i.is(":checked")?1:0;t[r]=o;break;case"radio":var o=e.find("input[name="+n+"]:checked").val();t[r]=o;break;case"select":var o=e.find("select[name="+n+"] option:selected").val();t[r]=o;break;default:t[r]=i.val()}});w(i,t,r)}};var l=function(t,n){m(t);var r=true;e.each(n,function(n,i){var s=t.find("[name="+i.name+"]");var o=s.val();if(g(s,"required")){if(!o){r=false;b(s)}}var u=s.attr("type");switch(u){case"number":if(!e.isNumeric(o)){r=false;b(s)}break;case"email":var a=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(!a.test(o)){r=false;b(s)}break}});if(!r){y(t)}return r};var c=function(t,n){var r=e("<div></div>");r.addClass("form-group");r.append("<label class='control-label'>"+n.label+":</label>");var i="<input type='"+t+"' name='"+n.name+"' class='form-control'";if(n.css){i=i.slice(0,-1);i+=" "+n.css+"'"}if(n.placeholder){i+=" placeholder='"+n.placeholder+"'"}if(n.attributes){i+=" "+n.attributes}i+=" />";r.append(i);return r};var h=function(t){var n=e("<div></div>");n.addClass("checkbox");var r=e("<label></label>");r.addClass("control-label");var i="<input type='checkbox' name='"+t.name+"'";if(t.css){i=i.slice(0,-1);i+=" "+t.css+"'"}if(t.attributes){i+=" "+t.attributes}i+=" />";r.append(i);r.append(t.label);n.append(r);return n};var p=function(t){var n=e("<div></div>");n.addClass("radio");var r=e("<label></label>");r.addClass("control-label");var i="<input type='radio' name='"+t.name+"' value='"+t.value+"'";if(t.css){i=i.slice(0,-1);i+=" "+t.css+"'"}if(t.attributes){i+=" "+t.attributes}i+=" />";r.append(i);r.append(t.label);n.append(r);return n};var d=function(t){var n=e("<div></div>");n.addClass("form-group");n.append("<label class='control-label'>"+t.label+":</label>");var r="<select name='"+t.name+"' class='form-control'";if(t.css){r=input.slice(0,-1);r+=" "+t.css+"'"}if(t.attributes){r+=" "+t.attributes}r+=">";if(t.placeholder){r+="<option value='0' disabled selected>"+t.placeholder+"</option>"}if(t.options){e.each(t.options,function(e,t){r+="<option value='"+t.id+"'>"+t.name+"</option>"})}r+="</select>";n.append(r);return n};var v=function(e){var t="<button type='button' class='btn btn-default'";if(e.css){t=t.slice(0,-1);t+=" "+e.css+"'"}t+=">"+e.label+"</button>";return t}};e.fn.TieJS=function(n){return this.each(function(){var r=e(this);if(r.data("tiejs")){return}r.data("tiejs",new t(this,n))})}})